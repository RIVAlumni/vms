<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>VMS Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" integrity="sha384-3zSEDfvllQohrq0PHL1fOXJuC/jSOO34H46t6UQfobFOmxE5BpjjaIJY5F2/bMnU" crossorigin="anonymous"></script>
    <script>
      function submitForm(e) {
      e.preventDefault();
      const fullname = document.getElementById("fullname").value;
      const nric = document.getElementById("nric").value;
      const phone = document.getElementById("phone").value;
      
      const text = `|${nric}|${phone}|${fullname}|`
      let qrcodeContainer = document.getElementById("qrcode");
      let returnText = document.getElementById("return_text");
      if (text!==returnText.innerHTML) {
        if (returnText.innerHTML) {
          qrcodeContainer.innerHTML = "";
          returnText.innerHTML = "";
        }
        if (text) {
          new QRCode(qrcodeContainer, text);
          returnText.innerHTML = text;
        }
      }
      }
    </script>
  </head>
  <body>
    <div class="container mt-5">
    <h1 class="text-center">RIVA Entry QR Code Generator</h1>
    <h4 class="text-center">Show us this QR code, AND your student pass/NRIC at the counter.</h1>
    <p id="operator_name" class="text-end" onclick="logout()"></p>
      <form onsubmit="submitForm(event)">
      <div class="mb-3">
        <label for="nric" class="form-label">NRIC</label>
        <input type="text" class="form-control" id="nric" name="nric" required placeholder="T0XXXXXXA" pattern="^\w\d{7}\w$">
      </div>
      <div class="mb-3">
        <label for="fullname" class="form-label">Full Name</label>
        <input type="text" class="form-control" id="fullname" name="fullname" maxlength="66" placeholder="Name on student pass/NRIC" required pattern="[A-Za-z0-9\s]+">
      </div>
      <div class="mb-3">
        <label for="phone" class="form-label">Phone Number</label>
        <input type="text" class="form-control" id="phone" name="phone" required placeholder="8XXXXXXX, no spaces" pattern="^\d{8}$">
      </div>
      <button type="submit" class="btn btn-success">Submit</button>
      </form>

    <div id="qrcode" class="qrcode" style="padding: 16px;"></div>
    <h2 id="return_text"></h2>
  </body>
</html>
